// S4 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

main()
{
    if ( getdvar( "#x32ea5e908954bfea7" ) == "mp_background" )
        return;

    _id_07B3::init();
    _id_07B3::_id_D849();

    if ( isusingmatchrulesdata() )
    {
        level._id_81CB = ::_id_81CB;
        [[ level._id_81CB ]]();
        level thread scripts\mp\utility\game::_id_C2DD();
    }
    else
    {
        scripts\mp\utility\game::_id_C29C( scripts\mp\utility\game::getgametype(), 0, 0, 9 );
        scripts\mp\utility\game::_id_C2B3( scripts\mp\utility\game::getgametype(), 10 );
        scripts\mp\utility\game::_id_C29F( scripts\mp\utility\game::getgametype(), 7500 );
        scripts\mp\utility\game::_id_C29B( scripts\mp\utility\game::getgametype(), 1 );
        scripts\mp\utility\game::_id_C2C2( scripts\mp\utility\game::getgametype(), 1 );
        scripts\mp\utility\game::_id_C270( scripts\mp\utility\game::getgametype(), 0 );
        scripts\mp\utility\game::_id_C24F( scripts\mp\utility\game::getgametype(), 0 );
        _func_01D2( "scr_tdef_possessionResetCondition", 1 );
        _func_01D2( "scr_tdef_possessionResetTime", 60 );
        level._id_9BD6 = 1;
        level._id_9BD4 = 0;
        level._id_9BD9 = 0;
    }

    level._id_32B0 = 100;
    level._id_CB1D = 1;
    _id_FC7A();
    level.teambased = 1;
    level._id_AB9A = ::_id_AB9A;
    level._id_AB46 = ::_id_AB46;
    level._id_6D2C = ::_id_6D2C;
    level._id_AB5D = ::_id_AB5D;
    level._id_AB79 = ::_id_6CD0;
    level._id_2188 = 1;
    level._id_212E = [];
    level._id_218A = [];
    level._id_216B = [];
    level._id_CBF8 = 0;
    level._id_2187 = 0;

    if ( level._id_9BD4 || level._id_9BD9 )
        level._id_9FF8 = _id_079A::_id_60B2;

    game["dialog"]["gametype"] = "team_defender";

    if ( getdvarint( "#x33b8132c2bbd3f240" ) )
        game["dialog"]["gametype"] = "hc_" + game["dialog"]["gametype"];

    game["strings"]["overtime_hint"] = &"MP/FIRST_BLOOD";
    game["dialog"]["drone_reset"] = "defender_obj_respawned";
    game["dialog"]["ally_own_drone"] = "tdef_ally_own_drone";
    game["dialog"]["enemy_own_drone"] = "tdef_enemy_own_drone";
    game["dialog"]["ally_throw_score"] = "ally_throw_score";
    game["dialog"]["ally_carry_score"] = "ally_carry_score";
    game["dialog"]["enemy_throw_score"] = "enemy_throw_score";
    game["dialog"]["enemy_carry_score"] = "enemy_carry_score";
    game["dialog"]["pass_complete"] = "friendly_pass";
    game["dialog"]["pass_intercepted"] = "tdef_pass_intercepted";
    game["dialog"]["ally_drop_drone"] = "tdef_ally_drop_drone";
    game["dialog"]["enemy_drop_drone"] = "tdef_enemy_drop_drone";
    game["dialog"]["drone_reset_soon"] = "team_defender_reset";
    game["bomb_dropped_sound"] = "mp_war_objective_lost";
    game["bomb_recovered_sound"] = "mp_war_objective_taken";
    game["dialog"]["offense_obj"] = "capture_obj";
    game["dialog"]["defense_obj"] = "capture_obj";
}

_id_81CB()
{
    scripts\mp\utility\game::_id_D4D3();
    _func_01D2( "scr_tdef_scoringTime", getmatchrulesdata( "tdefData", "scoringTime" ) );
    _func_01D2( "scr_tdef_scorePerTick", getmatchrulesdata( "tdefData", "scorePerTick" ) );
    _func_01D2( "scr_tdef_carrierBonusTime", getmatchrulesdata( "tdefData", "carrierBonusTime" ) );
    _func_01D2( "scr_tdef_carrierBonusScore", getmatchrulesdata( "tdefData", "carrierBonusScore" ) );
    _func_01D2( "scr_tdef_delayplayer", getmatchrulesdata( "tdefData", "delayPlayer" ) );
    _func_01D2( "scr_tdef_spawndelay", getmatchrulesdata( "tdefData", "spawnDelay" ) );
    _func_01D2( "scr_tdef_ballActivationDelay", getmatchrulesdata( "tdefData", "ballActivationDelay" ) );
    _func_01D2( "scr_tdef_possessionResetCondition", getmatchrulesdata( "ballCommonData", "possessionResetCondition" ) );
    _func_01D2( "scr_tdef_possessionResetTime", getmatchrulesdata( "ballCommonData", "possessionResetTime" ) );
    _func_01D2( "scr_tdef_explodeOnExpire", getmatchrulesdata( "ballCommonData", "explodeOnExpire" ) );
    _func_01D2( "scr_tdef_armorMod", getmatchrulesdata( "ballCommonData", "armorMod" ) );
    _func_01D2( "scr_tdef_showEnemyCarrier", getmatchrulesdata( "carryData", "showEnemyCarrier" ) );
    _func_01D2( "scr_tdef_idleResetTime", getmatchrulesdata( "carryData", "idleResetTime" ) );
    _func_01D2( "scr_tdef_halftime", 0 );
    scripts\mp\utility\game::_id_C24F( "tdef", 0 );
    _func_01D2( "scr_tdef_promode", 0 );
}

_id_AB9A()
{
    _func_01CE( "auto_change" );

    if ( !isdefined( game["switchedsides"] ) )
        game["switchedsides"] = 0;

    if ( game["switchedsides"] )
    {
        var_0 = game["attackers"];
        var_1 = game["defenders"];
        game["attackers"] = var_1;
        game["defenders"] = var_0;
    }

    foreach ( var_3 in level._id_EF86 )
    {
        scripts\mp\utility\game::_id_D610( var_3, &"OBJECTIVES/TDEF" );

        if ( level._id_E427 )
            scripts\mp\utility\game::_id_D60E( var_3, &"OBJECTIVES/TDEF" );
        else
            scripts\mp\utility\game::_id_D60E( var_3, &"OBJECTIVES/TDEF_SCORE" );

        scripts\mp\utility\game::_id_D609( var_3, &"OBJECTIVES/TDEF_ATTACKER_HINT" );
    }

    _id_3FAF();
    scripts\mp\gametypes\obj_ball::_id_20F2();
    scripts\mp\gametypes\obj_ball::_id_2109();
    scripts\mp\gametypes\obj_ball::_id_20EF();
    scripts\mp\gametypes\obj_ball::_id_212D( 0 );
    _id_827A();
    var_5[0] = scripts\mp\utility\game::getgametype();
    var_5[1] = "tdm";
    var_5[2] = "ball";
    _id_07AD::main( var_5 );
    _id_EF2F();

    if ( level._id_BA02 != 0 )
        scripts\mp\gametypes\obj_ball::_id_812A();
}

_id_FC7A()
{
    scripts\mp\gametypes\common::_id_FC36();
    level._id_CC19 = _id_0A66::_id_507A( "scoringTime", 1, 1, 10 );
    level._id_CC05 = _id_0A66::_id_507C( "scorePerTick", 1, 1, 25 );
    level._id_32B2 = _id_0A66::_id_507A( "carrierBonusTime", 4, 0, 10 );
    level._id_32B1 = _id_0A66::_id_507C( "carrierBonusScore", 25, 0, 250 );
    level._id_46B2 = _id_0A66::_id_507C( "delayPlayer", 1, 0, 1 );
    level._id_E292 = _id_0A66::_id_507A( "spawnDelay", 2.5, 0, 30 );
    level._id_2169 = _id_0A66::_id_507A( "ballActivationDelay", 10, 0, 30 );
    level._id_BA02 = _id_0A66::_id_507C( "possessionResetCondition", 0, 0, 2 );
    level._id_BA03 = _id_0A66::_id_507A( "possessionResetTime", 0, 0, 150 );
    level._id_5799 = _id_0A66::_id_507C( "explodeOnExpire", 0, 0, 1 );
    level._id_7CB5 = _id_0A66::_id_507A( "idleResetTime", 15, 0, 60 );
    level._id_1B31 = _id_0A66::_id_507A( "armorMod", 1, 0, 2 );
    level._id_DC9D = _id_0A66::_id_507C( "showEnemyCarrier", 5, 0, 6 );
    level._id_32B0 = int( level._id_32B0 * level._id_1B31 );
}

_id_827A()
{
    level._id_E324 = ( 0, 0, 0 );
    level._id_E321 = ( 0, 0, 0 );
    _id_07EE::_id_D454( "TDef", "Crit_Frontline" );
    _id_07EE::_id_1111( "mp_ball_spawn_allies_start" );
    _id_07EE::_id_1111( "mp_ball_spawn_axis_start" );
    _id_07EE::_id_110D( "allies", "mp_tdm_spawn" );
    _id_07EE::_id_110D( "allies", "mp_tdm_spawn_secondary", 1, 1 );
    _id_07EE::_id_110D( "axis", "mp_tdm_spawn" );
    _id_07EE::_id_110D( "axis", "mp_tdm_spawn_secondary", 1, 1 );
    _id_07EE::_id_C2AB( "normal", "mp_tdm_spawn" );
    _id_07EE::_id_C2AB( "fallback", "mp_tdm_spawn_secondary" );
    level._id_9A95 = _id_07EE::_id_5AC1( level._id_E324, level._id_E321 );
    setgameendtime( level._id_9A95 );

    foreach ( var_1 in level._id_E34A )
        _id_2ED5( var_1 );

    _id_07EE::_id_0EBC();
}

_id_2ED5( var_0 )
{
    var_0._id_4B97 = undefined;
    var_1 = _func_00C4( var_0.origin, level._id_212E[0]._id_718A, 1000 );

    if ( var_1 < 0 )
        var_1 = scripts\engine\utility::_id_4B6B( var_0.origin, level._id_212E[0]._id_718A );
    else
        var_1 = var_1 * var_1;

    var_0._id_4B97 = var_1;
}

_id_6D2C()
{
    var_0 = self.pers["team"];

    if ( game["switchedsides"] )
        var_0 = scripts\mp\utility\game::_id_6BC3( var_0 )[0];

    if ( _id_07EE::_id_DC03() )
    {
        var_1 = _id_07EE::_id_6D30( "mp_ball_spawn_" + var_0 + "_start" );
        var_2 = _id_07EE::_id_6D2F( var_1 );
    }
    else
    {
        var_3 = [];
        var_3["ballPosition"] = level._id_218A[0]._id_1042E[0].origin;

        if ( isdefined( level._id_218A[0]._id_32AF ) )
            var_3["activeCarrierPosition"] = level._id_218A[0]._id_32AF.origin;
        else
            var_3["activeCarrierPosition"] = var_3["ballPosition"];

        var_3["avoidBallDeadZoneDistSq"] = 1000000;
        var_2 = _id_07EE::_id_6D2C( self, var_0, "normal", "fallback", undefined, var_3 );
    }

    return var_2;
}

_id_3FAF()
{

}

_id_EF2F()
{
    level._id_7C3C = "waypoint_blitz_defend_round";
    level._id_7C3B = "waypoint_blitz_defend_round";
    level._id_7C51 = "waypoint_capture_kill_round";
    level._id_7C50 = "waypoint_capture_kill_round";
    level._id_7C2C = "waypoint_capture_take";
    level._id_7C2B = "waypoint_capture_take";
    level._id_20E2 = level._id_218A[0];
}

_id_AB5D( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8, var_9 )
{
    var_10 = self;
    var_11 = var_1.origin;
    var_12 = 0;

    if ( isdefined( var_0 ) )
    {
        var_11 = var_0.origin;
        var_12 = var_0 == var_1;
    }

    if ( isdefined( self._id_32C6 ) && isdefined( self._id_32C6._id_AEA1 ) && isdefined( self._id_32C6._id_AEA0 ) )
    {
        scripts\mp\utility\outline::outlinedisable( self._id_32C6._id_AEA1, self._id_32C6._id_AEA0 );
        self._id_32C6._id_AEA1 = undefined;
        self._id_32C6._id_AEA0 = undefined;
    }

    if ( isdefined( self._id_32C6 ) && isdefined( self._id_32C6._id_B71D ) && isdefined( self._id_32C6._id_B71C ) )
    {
        scripts\mp\utility\outline::outlinedisable( self._id_32C6._id_B71D, self._id_32C6._id_B71C );
        self._id_32C6._id_B71D = undefined;
        self._id_32C6._id_B71C = undefined;
    }

    if ( isdefined( level._id_20E2._id_32AF ) )
    {
        if ( isdefined( var_1 ) && isplayer( var_1 ) && var_1.pers["team"] != var_10.pers["team"] )
        {
            if ( isdefined( var_1._id_20E8 ) && var_12 )
            {

            }
            else if ( isdefined( var_10._id_20E8 ) )
                scripts\mp\gametypes\obj_ball::_id_FD64( "neutral", 1, 0 );

            if ( var_1.pers["team"] == level._id_20E2._id_AD9B && var_1 != level._id_20E2._id_32AF )
            {
                var_13 = distancesquared( level._id_20E2._id_32AF.origin, var_11 );

                if ( var_13 < 90000 )
                {
                    var_1 thread _id_0788::_id_6F9C( "mode_x_defend" );
                    var_1 _id_0A7B::_id_7D93( "defends", 1 );
                    var_1 _id_07D5::_id_E76D( "round", "defends", var_1.pers["defends"] );
                    var_1 _id_0A7B::_id_D544( var_1.pers["defends"] );
                }
            }
        }
    }
}

_id_1F9C( var_0 )
{
    level endon( "game_ended" );
    level._id_20E2 endon( "dropped" );
    level._id_20E2 endon( "reset" );
    level notify( "awardCapturePointsRunning" );
    level endon( "awardCapturePointsRunning" );

    if ( level._id_32B1 > 0 )
        level._id_20E2._id_32AF thread _id_32B4();

    var_1 = level._id_CC19;
    var_2 = level._id_CC05;

    while ( !level._id_609B )
    {
        wait( var_1 );
        scripts\mp\hostmigration::_id_10956();

        if ( !level._id_609B )
        {
            scripts\mp\gamescore::_id_6FE4( var_0, var_2, 0 );
            level._id_20E2._id_32AF _id_0A7B::_id_7D93( "objTime", 1 );
            level._id_20E2._id_32AF _id_07D5::_id_E76D( "round", "objTime", level._id_20E2._id_32AF.pers["objTime"] );
            level._id_20E2._id_32AF _id_0A7B::_id_D543( level._id_20E2._id_32AF.pers["objTime"] );
            level._id_20E2._id_32AF scripts\mp\gamescore::_id_6FB2( "tdef_hold_obj", 10 );
        }
    }
}

_id_32B4()
{
    level endon( "game_ended" );
    self endon( "death" );
    level._id_20E2 endon( "dropped" );
    level._id_20E2 endon( "reset" );

    for (;;)
    {
        wait( level._id_32B2 );
        thread _id_0A76::_id_6FE6( "ball_carry", undefined, level._id_32B1 );
    }
}

_id_10B0B()
{
    self endon( "dropped_flag" );
    self endon( "disconnect" );
    level waittill( "game_ended" );

    if ( isdefined( self ) )
    {
        if ( isdefined( self._id_EF30 ) )
        {
            var_0 = int( gettime() - self._id_EF30 );

            if ( var_0 / 100 / 60 < 1 )
                var_1 = 0;
            else
                var_1 = int( var_0 / 100 / 60 );

            _id_0A7B::_id_7D93( "destructions", var_1 );
            _id_07D5::_id_E76D( "round", "destructions", self.pers["destructions"] );
        }
    }
}

_id_6CD0()
{
    var_0 = level._id_20E2 _id_07AD::_id_6BE3();

    if ( isdefined( var_0 ) )
    {
        if ( self.pers["team"] == var_0 )
        {
            if ( !level._id_E292 )
                return undefined;

            if ( level._id_46B2 )
                return level._id_E292;
        }
    }
}

_id_AB46( var_0 )
{
    var_0._id_0B39 = [];
    thread _id_AB65( var_0 );
}

_id_AB65( var_0 )
{
    for (;;)
    {
        var_0 waittill( "spawned" );
        level._id_216B[0] scripts\mp\gametypes\obj_ball::_id_DC85( var_0 );
        var_0 _id_0A7B::_id_D543( 0 );

        if ( isdefined( var_0.pers["objTime"] ) )
            var_0 _id_0A7B::_id_D543( var_0.pers["objTime"] );

        var_0 _id_0A7B::_id_D544( 0 );

        if ( isdefined( var_0.pers["defends"] ) )
            var_0 _id_0A7B::_id_D544( var_0.pers["defends"] );
    }
}

_id_6D04()
{
    if ( istrue( self._id_EF31 ) )
    {
        if ( scripts\mp\utility\perk::_hasperk( "specialty_afterburner" ) )
        {
            self _meth_8485( 0, scripts\engine\utility::ter_op( scripts\mp\utility\game::_id_873A(), 600, 2000 ) );
            self _meth_8481( 0, scripts\engine\utility::ter_op( scripts\mp\utility\game::_id_873A(), 750, 650 ) );
        }
        else
        {
            self _meth_8485( 0, 400 );
            self _meth_8481( 0, 900 );
        }

        self._id_EF31 = 0;
    }
    else
    {
        if ( scripts\mp\utility\perk::_hasperk( "specialty_afterburner" ) )
        {
            self _meth_8485( 0, 250 );
            self _meth_8481( 0, 1350 );
        }
        else
        {
            self _meth_8485( 0, 200 );
            self _meth_8481( 0, 1800 );
        }

        self._id_EF31 = 1;
    }
}
