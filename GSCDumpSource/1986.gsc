// S4 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

init()
{

}

_id_101B( var_0, var_1, var_2, var_3, var_4, var_5 )
{
    if ( !isdefined( var_2 ) )
        var_2 = 0;

    if ( var_4 == 0 )
        var_4 = undefined;

    if ( !isdefined( self._id_9446 ) || self._id_9446.size == 0 )
    {
        var_6 = [];
        var_6[0] = spawnstruct();
        self._id_9446 = var_6;
    }
    else
    {
        var_7 = scripts\engine\utility::_id_1BA9( self._id_9446 );
        self._id_9446 = var_7;
        self._id_9446[self._id_9446.size] = spawnstruct();
    }

    self._id_9446[self._id_9446.size - 1]._id_9109 = var_0;
    self._id_9446[self._id_9446.size - 1]._id_BE1B = var_1;
    self._id_9446[self._id_9446.size - 1]._id_BD19 = var_2;
    self._id_9446[self._id_9446.size - 1]._id_5314 = var_3;
    self._id_9446[self._id_9446.size - 1]._id_F23E = gettime();
    self._id_9446[self._id_9446.size - 1]._id_56D1 = 0;
    self._id_9446[self._id_9446.size - 1]._id_5315 = var_5;

    if ( isdefined( var_4 ) )
        self._id_9446[self._id_9446.size - 1]._id_F1E5 = var_4 * 1000;
    else
        self._id_9446[self._id_9446.size - 1]._id_F1E5 = undefined;

    if ( isdefined( var_3 ) && var_3 )
        thread _id_52E8( self._id_9446[self._id_9446.size - 1] );

    if ( isdefined( var_5 ) )
        thread _id_5302( var_5, self._id_9446[self._id_9446.size - 1] );

    thread _id_9A0A();
}

_id_9A0A()
{
    self notify( "manageLightBarStack" );
    self endon( "manageLightBarStack" );
    self endon( "disconnect" );

    for (;;)
    {
        wait 0.05;

        if ( self._id_9446.size > 1 )
        {
            var_0 = _id_C527( self._id_9446 );
            var_1 = scripts\engine\utility::_id_1BAE( var_0, ::_id_85D8 );
        }
        else
            var_1 = self._id_9446;

        if ( var_1.size == 0 )
            return;

        self._id_9446 = var_1;
        var_2 = var_1[0];

        if ( var_2._id_56D1 )
            continue;

        var_3 = !isdefined( self._id_9446[self._id_9446.size - 1]._id_F1E5 );
        var_4 = 0;

        if ( !var_3 )
        {
            var_5 = gettime() - var_2._id_F23E;
            var_4 = var_2._id_F1E5 - var_5;
            var_4 = var_4 / 1000;

            if ( var_4 <= 0 )
            {
                self._id_9446[0] notify( "removed" );
                self._id_9446[0] = undefined;
                _id_381C();
                _id_9A0A();
            }
        }

        if ( var_3 )
        {
            if ( var_2._id_5314 )
            {
                var_2 notify( "executing" );
                var_2._id_56D1 = 1;
                thread _id_D26D( var_2._id_9109, var_2._id_BE1B );
            }
            else
                thread _id_D26C( var_2._id_9109, var_2._id_BE1B );

            continue;
        }

        if ( var_2._id_5314 )
        {
            var_2 notify( "executing" );
            var_2._id_56D1 = 1;
            thread _id_D269( var_2._id_9109, var_2._id_BE1B, var_4 );
            continue;
        }

        thread _id_D268( var_2._id_9109, var_2._id_BE1B, var_4 );
    }
}

_id_381C()
{
    var_0 = scripts\engine\utility::_id_1BA9( self._id_9446 );
    self._id_9446 = var_0;
}

_id_C527( var_0 )
{
    var_1 = [];

    foreach ( var_3 in var_0 )
    {
        if ( !isdefined( var_3._id_F1E5 ) )
        {
            var_1[var_1.size] = var_3;
            continue;
        }

        var_4 = gettime() - var_3._id_F23E;
        var_5 = var_3._id_F1E5 - var_4;
        var_5 = var_5 / 1000;

        if ( var_5 > 0 )
            var_1[var_1.size] = var_3;
    }

    return var_1;
}

_id_85D8( var_0, var_1 )
{
    return var_0._id_BD19 > var_1._id_BD19;
}

_id_D265( var_0, var_1 )
{
    _id_D26E( var_1 );
    _id_D266( var_0 );
    _id_D26B();
}

_id_D268( var_0, var_1, var_2 )
{
    self notify( "set_lightbar_for_time" );
    self endon( "set_lightbar_for_time" );
    _id_D26E( var_1 );
    _id_D266( var_0 );
    _id_D26B();
    wait( var_2 );

    if ( !isdefined( self ) )
        return;

    _id_D26A();
    self._id_9446 = undefined;
    _id_381C();
}

_id_D26C( var_0, var_1 )
{
    self notify( "set_lightbar" );
    self endon( "set_lightbar" );
    _id_D26E( var_1 );
    _id_D266( var_0 );
    _id_D26B();
}

_id_D267( var_0, var_1 )
{
    _id_D26E( var_1 );
    _id_D266( var_0 );
    _id_D26B();
    thread _id_F7F0();
}

_id_D269( var_0, var_1, var_2 )
{
    self notify( "set_lightbar_for_time_endon_death" );
    self endon( "set_lightbar_for_time_endon_death" );
    _id_D26E( var_1 );
    _id_D266( var_0 );
    _id_D26B();
    thread _id_F7F0();
    wait( var_2 );

    if ( !isdefined( self ) )
        return;

    _id_D26A();
    self._id_9446[0] notify( "removed" );
    self._id_9446[0] = undefined;
    _id_381C();
}

_id_D26D( var_0, var_1 )
{
    self notify( "set_lightbar_endon_death" );
    self endon( "set_lightbar_endon_death" );
    _id_D26E( var_1 );
    _id_D266( var_0 );
    _id_D26B();
    thread _id_F7F0();
}

_id_52E8( var_0 )
{
    self notify( "endInactiveInstructionOnDeath" );
    self endon( "endInactiveInstructionOnDeath" );
    var_0 endon( "executing" );
    self waittill( "death" );

    if ( !isdefined( self ) )
        return;

    if ( self._id_9446.size == 0 )
        return;

    self._id_9446[0] notify( "removed" );
    self._id_9446[0] = undefined;
    _id_381C();
}

_id_5302( var_0, var_1 )
{
    var_1 endon( "removed" );

    if ( _func_0106( var_0 ) )
        var_2 = scripts\engine\utility::_id_10890( var_0 );
    else
        self waittill( var_0 );

    if ( !isdefined( self ) )
        return;

    for ( var_3 = 0; var_3 < self._id_9446.size; var_3++ )
    {
        if ( var_1 == self._id_9446[var_3] )
        {
            if ( var_1._id_56D1 )
                _id_D26A();

            self._id_9446[var_3] = undefined;
            _id_381C();
            return;
        }
    }
}

_id_F7F0()
{
    self notify( "turn_Off_Light_Bar_On_Death" );
    self endon( "turn_Off_Light_Bar_On_Death" );
    self waittill( "death" );

    if ( !isdefined( self ) )
        return;

    if ( self._id_9446.size == 0 )
        return;

    _id_D26A();
    self._id_9446[0] notify( "removed" );
    self._id_9446[0] = undefined;
    _id_381C();
}

_id_D266( var_0 )
{
    self setclientomnvar( "lb_color", var_0 );
}

_id_D26B()
{
    self setclientomnvar( "lb_gsc_controlled", 1 );
}

_id_D26A()
{
    self setclientomnvar( "lb_gsc_controlled", 0 );
}

_id_D26E( var_0 )
{
    self setclientomnvar( "lb_pulse_time", var_0 );
}
