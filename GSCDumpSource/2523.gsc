// S4 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

_id_2E3A( var_0, var_1 )
{
    thread _id_2E40();
}

_id_2E3E( var_0 )
{
    self endon( "disconnect" );
    var_0 endon( "death" );
    _id_0A77::_id_BD07( "c4 spawn", var_0.owner );
    var_0._id_F1D0 = gettime();
    var_0 _id_0765::_id_C2A7( 1, ::_id_EC0F );
    _id_2E1C( var_0.owner, var_0 );
    thread _id_2E41();
    thread _id_2E40();

    if ( scripts\mp\utility\perk::_hasperk( "specialty_rugged_eqp" ) )
        var_0._id_758C = 1;

    var_0 thread scripts\mp\weapons::_id_9EBB();
    var_0 thread _id_2E2F();
    var_0 thread _id_2E28();
    thread scripts\mp\weapons::_id_A0F3( self, var_0 );
    var_0 waittill( "missile_stuck" );
    var_0 setotherent( self );
    var_0 _meth_8357( 1 );
    scripts\mp\weapons::_id_AABC( var_0, "equip_c4", ::_id_2E24 );
    thread scripts\mp\weapons::_id_A0F2( self, var_0 );
    var_0 thread scripts\mp\weapons::_id_99D8( "tag_use", 1 );
    var_0 _id_07E9::_id_C2A4( "Lethal_Static", var_0.owner, 1 );
    var_0 _id_0764::_id_D151( ::_id_2E2C );
    var_0 thread _id_0A40::_id_CA27();
    var_0 setscriptablepartstate( "effects", "plant", 0 );
    thread scripts\mp\weapons::_id_ACC5( var_0 );
    var_0 _meth_85B7();
    var_0 _meth_85B8();
    var_0._id_75D8 = var_0 _id_0766::_id_D587( 0, 0, undefined, undefined, undefined, 0.1, 1 );
    var_0 _id_2E3C();
}

_id_2E3C()
{
    if ( istrue( level._id_432C ) )
        return;

    if ( isdefined( self._id_4325 ) )
        _id_07EE::_id_C511( self._id_4325 );

    var_0 = ( self.origin[0], self.origin[1], self.origin[2] - 50.0 );
    self._id_4325 = _id_07EE::_id_110C( var_0, _id_07EE::_id_69B5(), 100, self.owner.team, undefined, self.owner, 0, self, 1 );
}

_id_2E29( var_0 )
{
    self endon( "death" );
    self.owner endon( "disconnect" );

    if ( isdefined( var_0 ) )
        var_0 endon( "disconnect" );
    else
        var_0 = self.owner;

    wait 0.1;
    thread _id_2E2E( var_0 );
}

_id_2E2E( var_0 )
{
    _id_0A77::_id_BD07( "c4 triggered", self.owner );
    level notify( "explosion_extinguish", self.origin, 256, self.owner, self );
    var_1 = undefined;
    var_2 = undefined;
    var_3 = self.origin;
    var_4 = scripts\engine\trace::_id_3EC3( 0, 1, 1, 0, 1, 1, 0, 0, 0 );
    var_5 = vectordot( ( 0, 0, 1 ), anglestoup( self.angles ) );

    if ( abs( var_5 ) <= 0.81915 )
    {
        var_6 = var_3 - anglestoup( self.angles ) * 5;
        var_7 = _func_02BC( var_3, var_6, var_4, self, 0, "physicsquery_closest", 1 );

        if ( isdefined( var_7 ) && var_7.size > 0 )
        {
            var_1 = 5;
            var_2 = "explodeWall";
        }
    }
    else if ( var_5 <= -0.96592 )
    {
        var_6 = var_3 - anglestoup( self.angles ) * 5;
        var_7 = _func_02BC( var_3, var_6, var_4, self, 0, "physicsquery_closest", 1 );

        if ( isdefined( var_7 ) && var_7.size > 0 )
        {
            var_1 = 5;
            var_2 = "explodeWall";
        }
    }

    if ( !isdefined( var_1 ) )
    {
        var_6 = var_3 - ( 0, 0, 20 );
        var_7 = _func_02BC( var_3, var_6, var_4, self, 0, "physicsquery_closest", 1 );

        if ( !isdefined( var_7 ) || var_7.size <= 0 )
        {
            var_1 = 5;
            var_2 = "explodeAir";
        }
    }

    if ( !isdefined( var_1 ) )
    {
        var_1 = 5;
        var_2 = "explode";
    }

    thread _id_2E24( var_1 );
    self setentityowner( var_0 );
    self _meth_85AC();
    self setscriptablepartstate( "effects", var_2, 0 );
}

_id_EC0F()
{
    thread _id_2E24();
}

_id_2E26( var_0 )
{
    thread _id_2E24( 5 );
    self setscriptablepartstate( "effects", "destroy", 0 );
}

_id_2E24( var_0 )
{
    self notify( "death" );
    level._id_9ECB[self getentitynumber()] = undefined;
    self setcandamage( 0 );
    scripts\mp\weapons::_id_99D5();
    _id_0765::_id_47E6();
    _id_0766::_id_D586( self._id_75D8 );
    self._id_75D8 = undefined;
    self._id_57AE = 1;

    if ( isdefined( self._id_4325 ) )
    {
        _id_07EE::_id_C511( self._id_4325 );
        self._id_4325 = undefined;
    }

    var_1 = self.owner;

    if ( isdefined( var_1 ) )
    {
        _id_2E36( var_1, self, self getentitynumber() );
        var_1 scripts\mp\weapons::_id_C48A( self );
        var_1 notify( "c4_update", 0 );
    }

    thread _id_2E39();

    if ( isdefined( var_0 ) )
        wait( var_0 );

    self delete();
}

_id_2E39()
{
    self endon( "death" );
    wait 0.5;
    var_0 = self _meth_8151();

    if ( isdefined( var_0 ) )
    {
        var_0 waittill( "death" );
        self setscriptablepartstate( "effects", "neutral", 0 );
    }
}

_id_2E2F()
{
    self endon( "death" );
    level endon( "game_ended" );
    var_0 = self.owner;
    self waittill( "detonateExplosive", var_1 );

    if ( isdefined( var_1 ) )
        thread _id_2E2E( var_1 );
    else
        thread _id_2E2E( var_0 );
}

_id_2E2C( var_0 )
{
    var_1 = var_0.attacker;
    var_2 = var_0.objweapon;

    if ( istrue( scripts\cp_mp\utility\player_utility::_id_B779( self.owner, var_1 ) ) )
    {
        var_1 notify( "destroyed_equipment" );
        var_1 scripts\mp\killstreaks\killstreaks::_id_6FCD( self );
    }

    var_3 = "";

    if ( istrue( self._id_758C ) )
        var_3 = "hitequip";

    if ( isplayer( var_1 ) )
        var_1 _id_079B::_id_FC44( var_3 );

    thread _id_2E26();
}

_id_2E28()
{
    self endon( "death" );
    level scripts\engine\utility::waittill_any_2( "game_ended", "bro_shot_start" );
    thread _id_2E26();
}

_id_2E3F()
{
    if ( !scripts\mp\utility\player::isreallyalive( self ) )
        return 0;

    if ( scripts\mp\utility\player::_id_8AB5() )
        return 0;

    if ( !isdefined( self._id_2E4C ) || self._id_2E4C.size <= 0 )
        return 0;

    return 1;
}

_id_2E22()
{
    return ( gettime() - self._id_F1D0 ) / 1000 > 0.3;
}

_id_2E41()
{
    self endon( "death_or_disconnect" );
    self endon( "c4_unset" );
    level endon( "game_ended" );
    self notify( "watchForDetonation" );
    self endon( "watchForDetonation" );

    for (;;)
    {
        self waittill( "detonate" );

        if ( self getheldoffhand().basename == "s4_c4_mp" || self getheldoffhand().basename == "s4_eq_gesture_detonate_mp" )
            thread _id_2E2A();
    }
}

_id_2E40()
{
    self endon( "death_or_disconnect" );
    self endon( "c4_unset" );
    level endon( "game_ended" );
    self notify( "watchForAltDetonation" );
    self endon( "watchForAltDetonation" );

    while ( self usebuttonpressed() )
        waitframe();

    var_0 = 0;
    var_1 = level._id_5F1B;

    for (;;)
    {
        if ( self usebuttonpressed() )
        {
            var_0 = 0;

            while ( self usebuttonpressed() )
            {
                var_0 = var_0 + var_1;
                wait( var_1 );
            }

            if ( var_0 >= 0.5 )
                continue;

            var_0 = 0;

            while ( !self usebuttonpressed() && var_0 < 0.25 )
            {
                var_0 = var_0 + var_1;
                wait( var_1 );
            }

            if ( var_0 >= 0.25 )
                continue;

            if ( _id_2E3F() )
            {
                thread _id_2E1D();
                wait 1.26;
                thread _id_2E2A();
            }
        }

        waitframe();
    }
}

_id_2E1D()
{
    var_0 = makeweapon( "s4_eq_gesture_detonate_mp" );
    self _meth_8529( var_0 );
    thread _id_2E1E();
}

_id_2E1E()
{
    self endon( "death_or_disconnect" );
    self notify( "c4_animDetonateCleanup()" );
    self endon( "c4_animDetonateCleanup()" );
    var_0 = makeweapon( "s4_eq_gesture_detonate_mp" );
    wait 1;

    if ( self hasweapon( var_0 ) )
        self takeweapon( var_0 );
}

_id_2E2A()
{
    if ( isdefined( self._id_2E4C ) )
    {
        foreach ( var_1 in self._id_2E4C )
        {
            if ( var_1 _id_2E22() )
                var_1 thread _id_2E29();
        }
    }
}

_id_2E33( var_0 )
{
    if ( istrue( self._id_57AE ) )
        return;

    _id_2E36( var_0, self, self getentitynumber() );
    thread _id_2E26();
}

_id_2E38()
{
    if ( scripts\mp\equipment::_id_753F( "equip_c4" ) )
        thread _id_2E40();
}

_id_2E1C( var_0, var_1 )
{
    if ( !isdefined( var_0._id_2E4C ) )
        var_0._id_2E4C = [];

    var_2 = var_1 getentitynumber();
    var_0._id_2E4C[var_2] = var_1;
    var_0 _meth_8838( 1 );
    thread _id_2E37( var_0, var_1, var_2 );
}

_id_2E36( var_0, var_1, var_2 )
{
    if ( isdefined( var_1 ) )
        var_1 notify( "c4_removeFromArray" );

    if ( isdefined( var_0 ) && isdefined( var_0._id_2E4C ) )
    {
        var_0._id_2E4C[var_2] = undefined;

        foreach ( var_4 in var_0._id_2E4C )
        {
            if ( isdefined( var_4 ) )
                return;
        }

        var_0 _meth_8838( 0 );
    }
}

_id_2E37( var_0, var_1, var_2 )
{
    var_1 endon( "c4_removeFromArray" );
    var_0 endon( "disconnect" );
    var_1 waittill( "death" );
    thread _id_2E36( var_0, var_1, var_2 );
}
