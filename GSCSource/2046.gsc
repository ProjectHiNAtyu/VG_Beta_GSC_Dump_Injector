// S4 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

init()
{
    _id_0A7A::_id_C27F( ::_id_AB65 );
    setsaveddvar( "scr_suppression", 0 );
}

_id_AB65()
{
    self._id_0DAF = [];
    thread _id_10E14();
}

_id_10E14()
{
    self endon( "death_or_disconnect" );
    level endon( "game_ended" );
    var_0 = gettime();

    for (;;)
    {
        self waittill( "bulletwhizby", var_1, var_2 );
        var_0 = _id_4E8C( var_1, var_0 );
    }
}

_id_4E8C( var_0, var_1 )
{
    if ( gettime() - var_1 > 190 && !scripts\mp\utility\player::_id_8AB5() && getdvar( "scr_whizby_off" ) == "" )
    {
        thread _id_10E11( var_0 );
        var_1 = gettime();
    }

    var_2 = var_0 getcurrentweapon();

    if ( weaponclass( var_2 ) == "sniper" )
        scripts\mp\battlechatter_mp::_id_F756( self, "flavor_surprise", undefined, 0.2 );

    thread scripts\mp\battlechatter_mp::_id_10F6( var_0 );
    return var_1;
}

_id_4E8D()
{
    foreach ( var_1 in self._id_0DAF )
    {
        if ( isalive( var_1 ) )
            var_1 delete();
    }

    if ( isdefined( self ) )
        self setclientomnvar( "ui_whizby_event", 0 );
}

_id_10E11( var_0 )
{
    if ( getdvarint( "scr_suppression", 1 ) == 1 )
    {
        var_1 = var_0 getcurrentweapon();
        var_2 = weaponclass( var_1 );

        if ( var_1 _meth_8622( "linearbrake", 1 ) && !scripts\mp\utility\weapon::_id_88DC( var_1 ) && !scripts\mp\utility\perk::_hasperk( "specialty_blastshield" ) )
        {
            if ( !isdefined( self._id_EBB8 ) )
                self._id_EBB8 = 0;

            self notify( "whizbyBlur_reset" );
            var_3 = self._id_EBB8;
            self._id_EBB8 = clamp( self._id_EBB8 + _id_6D8B( var_2, self, var_0 ), 0, 100 );
            scripts\mp\gamescore::_id_F3F7( var_0, self, var_1.basename );
            thread _id_10E10( var_3, self._id_EBB8 );
        }
    }
}

_id_10E10( var_0, var_1 )
{
    self endon( "death_or_disconnect" );
    self endon( "whizbyBlur_reset" );
    var_2 = 0.3;

    while ( var_0 < var_1 )
    {
        var_0 = var_0 + 20;
        self earthquakeforplayer( var_2, 1.1, self.origin, 100 );
        var_2 = var_2 + 0.1;
        wait 0.05;
    }
}

_id_10E0F( var_0, var_1 )
{
    self endon( "death_or_disconnect" );
    self endon( "whizbyBlur_reset" );

    while ( self._id_EBB8 > 0 )
    {
        self._id_EBB8 = self._id_EBB8 - 2.5;

        if ( self._id_EBB8 < 0 )
            self._id_EBB8 = 0;

        var_2 = clamp( self._id_EBB8, 0, 100 );
        wait 0.2;
    }

    self._id_EBB8 = 0;
    scripts\mp\gamescore::_id_FB29( var_0, self, var_1 );
}

_id_6D8B( var_0, var_1, var_2 )
{
    var_3 = distance2d( var_1.origin, var_2.origin );

    if ( var_3 < 1024 )
        var_3 = var_3 * 0.25;

    switch ( var_0 )
    {
        case "mg":
            return 10.0 * ( var_3 / 1024 );
        case "sniper":
            return 5.0 * ( var_3 / 1024 );
        default:
            return 0;
    }
}
