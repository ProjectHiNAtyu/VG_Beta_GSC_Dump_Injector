// S4 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

init()
{
    precachemodel( "uk_electrical_box_medium_02_animated" );
    precachemodel( "uk_storage_wall_light_01" );
    precachemodel( "uk_storage_wall_light_01_on" );
    precachemodel( "uk_industrial_light_01" );
    precachemodel( "uk_industrial_light_01_on" );
    precachemodel( "p7_lights_cagelight02" );
    precachemodel( "p7_lights_cagelight02_on" );
    precachemodel( "uk_lighting_interior_office_ceiling_tile_01" );
    precachemodel( "uk_lighting_interior_office_ceiling_tile_01_on" );
    precachemodel( "uk_industrial_light_01_runner_pm" );
    precachemodel( "uk_industrial_light_01_runner_pm_on" );
    precachemodel( "ind_flood_light_standing_tall" );
    precachemodel( "ind_flood_light_standing_tall_on" );
    precachemodel( "rogue_dormitory_lobby_ceiling_light_01" );
    precachemodel( "rogue_dormitory_lobby_ceiling_light_01_on" );
    precachemodel( "light_ceiling_bulb_02_spear_pm" );
    precachemodel( "light_ceiling_bulb_02_spear_pm_on" );
    precachemodel( "me_light_ceiling_fluorescent_tube_strong_runner_pm" );
    precachemodel( "me_light_ceiling_fluorescent_tube_strong_runner_pm_on" );
    precachemodel( "me_light_ceiling_fluorescent_tube_spear_pm" );
    precachemodel( "me_light_ceiling_fluorescent_tube_spear_pm_on" );
    precachemodel( "lighting_fixtures_security_lamp_withcage_01_spear_pm" );
    precachemodel( "lighting_fixtures_security_lamp_withcage_01_spear_pm_on" );
    precachemodel( "ee_light_mounted_exterior_industrial_caged_02_spear_pm" );
    precachemodel( "ee_light_mounted_exterior_industrial_caged_02_spear_pm_on" );
    precachemodel( "ee_light_mounted_exterior_industrial_caged_02_on_green_rnr_pm" );
    precachemodel( "building_cable_post_light_pole_off_spear_pm" );
    precachemodel( "building_cable_post_light_pole_on_spear_pm" );
    precachemodel( "ee_electronics_television_wall_mounted_large_runner_pm" );
    precachemodel( "ee_electronics_television_wall_mounted_large_runner_pm_on" );
    level._effect["vfx_nvg_flare"] = loadfx( "vfx/iw8_mp/level/hackyard/vfx_nvg_flare.vfx" );
    level._effect["vfx_nvg_flare_light_250"] = loadfx( "vfx/iw8_mp/level/hackyard/vfx_nvg_flare_light_250.vfx" );
    thread _id_A1A6();
    _id_CDB1();
}

#using_animtree("script_model");

_id_CDB1()
{
    level._id_CC27["lightswitch"] = #animtree;
    level._id_CC24["lightswitch"]["interact"] = %wm_eq_fusebox_plr;
    level._id_CC25["lightswitch"]["interact"] = "wm_eq_fusebox_plr";
    level._id_CC2E["lightswitch"]["interact"] = "eq_fusebox_plr";
    level._id_CC24["lightswitch"]["interact_on"] = %wm_eq_fusebox_turn_on_plr;
    level._id_CC25["lightswitch"]["interact_on"] = "wm_eq_fusebox_turn_on_plr";
    level._id_CC2E["lightswitch"]["interact_on"] = "eq_fusebox_turn_on_plr";
    level._id_CC27["switch"] = #animtree;
    level._id_CC24["switch"]["interact"] = %wm_eq_fusebox_prop;
    level._id_CC25["switch"]["interact"] = "wm_eq_fusebox_prop";
    level._id_CC24["switch"]["interact_on"] = %wm_eq_fusebox_turn_on_prop;
    level._id_CC25["switch"]["interact_on"] = "wm_eq_fusebox_turn_on_prop";
    level._id_8375 = _func_0079( level._id_CC24["lightswitch"]["interact"] );
}

_id_A1A6()
{
    wait 5;
    var_0 = getentarray( "md_volume", "script_noteworthy" );

    foreach ( var_2 in var_0 )
    {
        var_3 = var_2 scripts\engine\utility::_id_678A();
        var_2 thread _id_A1A4( var_3 );
    }
}

_id_947F( var_0, var_1 )
{
    wait( var_0 );

    if ( self._id_00E1 == "light" )
    {
        if ( !isdefined( self._id_CB3E ) )
            var_2 = 50;
        else
            var_2 = self._id_CB3E;

        self _meth_8337( var_2 * 0.7 );
        thread scripts\engine\utility::_id_B2C7( "mp_lights_int_on", self.origin );
        wait 0.1;
        thread scripts\engine\utility::_id_B265( "mp_lights_int_on_loop" );
        self _meth_8337( var_2 * 0.1 );
        wait 0.05;
        self _meth_8337( var_2 * 0.4 );
        wait 0.1;
        self _meth_8337( var_2 * 0.2 );
        wait 0.15;
        self _meth_8337( var_2 );
    }
    else if ( self._id_00E1 == "scriptable" )
        self setscriptablepartstate( "light", "light_on" );
}

_id_947E( var_0, var_1 )
{
    foreach ( var_3 in var_0 )
    {
        if ( var_3._id_00E1 == "light" )
        {
            var_3 _meth_8337( 0 );
            var_3 thread scripts\engine\utility::_id_B2C7( "mp_lights_int_off", var_3.origin );
            var_3 notify( "stop soundmp_lights_int_on_loop" );
            continue;
        }

        if ( var_3._id_00E1 == "scriptable" )
            var_3 setscriptablepartstate( "light", "power_off" );
    }
}

_id_A1A4( var_0 )
{
    level endon( "game_ended" );
    var_1 = spawnstruct();
    var_1._id_0026 = undefined;
    var_1._id_9B8C = [];
    var_1._id_9484 = [];
    var_1._id_9FCC = [];
    var_1._id_A7AA = [];
    var_1._id_EC33 = "motion";
    var_1._id_9497 = 0;
    var_1._id_487D = 0;
    var_1._id_F60B = undefined;

    foreach ( var_3 in var_0 )
    {
        if ( var_3._id_00E1 == "light" )
        {
            var_1._id_9484[var_1._id_9484.size] = var_3;
            continue;
        }

        if ( isdefined( var_3._id_0375 ) && var_3._id_0375 == "masterSwitch" )
        {
            var_1._id_9B8C[var_1._id_9B8C.size] = var_3;
            continue;
        }

        if ( var_3._id_00E1 == "script_model" && !isdefined( var_3._id_CE0B ) )
        {
            var_1._id_9FCC[var_1._id_9FCC.size] = var_3;
            continue;
        }

        if ( var_3._id_00E1 == "script_origin" )
        {
            var_1._id_A7AA[var_1._id_A7AA.size] = var_3;
            continue;
        }

        if ( isdefined( var_3._id_CD8C ) && var_3._id_CD8C == "blinding_volume" )
            var_1._id_F60B = var_3;
    }

    var_5 = getscriptablearray( self.target, "targetname" );
    var_1._id_9484 = scripts\engine\utility::array_combine( var_1._id_9484, var_5 );

    foreach ( var_7 in var_1._id_9484 )
    {
        if ( var_7._id_00E1 == "light" )
        {
            var_7._id_CB3E = var_7 _meth_8146();
            var_7 _meth_8337( 0 );
            continue;
        }

        if ( var_7._id_00E1 == "scriptable" )
            var_7 setscriptablepartstate( "light", "power_off" );
    }

    foreach ( var_10 in var_1._id_9B8C )
        var_10 thread _id_CA3F( self, var_1 );

    foreach ( var_13 in var_1._id_9FCC )
        var_13._id_02AF = var_13.model;

    if ( scripts\mp\utility\game::getgametype() == "cyber" )
    {
        if ( !isdefined( level._id_5195 ) )
            level._id_5195 = [];

        level._id_5195 = scripts\engine\utility::array_add( level._id_5195, var_1 );
        thread scripts\mp\gametypes\cyber::_id_5196();
    }

    thread _id_AB33( var_1._id_9FCC, "off" );
    thread _id_A1A5( var_1 );

    for (;;)
    {
        if ( var_1._id_EC33 == "on" )
        {
            self notify( "masterSwitch_on" );

            if ( !var_1._id_9497 )
            {
                thread _id_2551( var_1 );

                foreach ( var_7 in var_1._id_9484 )
                    var_7 thread _id_947F( randomfloat( 0.2 ), var_1._id_A7AA );

                thread _id_AB33( var_1._id_9FCC, "on" );
                var_1._id_9497 = 1;
            }
        }
        else if ( var_1._id_EC33 == "motion" )
        {
            if ( var_1._id_487D && !var_1._id_9497 )
            {
                thread _id_2551( var_1 );

                foreach ( var_7 in var_1._id_9484 )
                {
                    var_7 thread _id_947F( randomfloat( 0.2 ), var_1._id_A7AA );
                    var_1._id_9497 = 1;
                }

                thread _id_AB33( var_1._id_9FCC, "on" );
                thread _id_A1A3( var_1 );
            }
        }
        else if ( var_1._id_EC33 == "off" )
        {
            if ( var_1._id_9497 )
            {
                level _id_947E( var_1._id_9484, var_1._id_A7AA );
                thread _id_AB33( var_1._id_9FCC, "off" );
                var_1._id_9497 = 0;
            }

            if ( isdefined( self._id_CE0B ) && self._id_CE0B == "motion" )
                var_1._id_EC33 = "motion";

            self notify( "lights_off" );
        }

        wait 0.05;
    }
}

_id_2551( var_0 )
{
    if ( isdefined( var_0._id_F60B ) )
    {
        wait 0.4;

        foreach ( var_2 in level.players )
        {
            if ( !isdefined( var_2 ) || !scripts\mp\utility\player::isreallyalive( var_2 ) )
                continue;

            if ( var_2 _meth_81EF( var_0._id_F60B ) )
            {
                var_2 _meth_8246();
                continue;
            }

            foreach ( var_4 in var_0._id_9484 )
            {
                if ( distancesquared( var_4.origin, var_2.origin ) > 230400 )
                    continue;

                if ( !scripts\engine\utility::_id_10E74( var_2 geteye(), var_2 getplayerangles(), var_4.origin, 0.707106 ) )
                    continue;

                var_5 = scripts\engine\trace::ray_trace( var_2 geteye(), var_4.origin, undefined, scripts\engine\trace::_id_3ED4( 1 ) );

                if ( distancesquared( var_5["position"], var_4.origin ) <= 324 )
                {
                    var_2 _meth_8246();
                    break;
                }
            }
        }
    }
}

_id_A3BD( var_0 )
{
    level endon( "game_ended" );

    for (;;)
    {
        if ( var_0._id_9497 == 0 )
        {
            foreach ( var_2 in level.players )
            {
                if ( var_2 _meth_81EF( self ) )
                    var_2 thread _id_9A11( self, var_0 );
            }
        }

        wait 0.1;
    }
}

_id_9A11( var_0, var_1 )
{
    level endon( "game_ended" );
    self endon( "death_or_disconnect" );

    if ( isdefined( self._id_7DDE ) )
        return;

    scripts\mp\utility\perk::_id_6FA5( "specialty_spygame" );
    self._id_7DDE = 1;

    while ( self _meth_81EF( var_0 ) && var_1._id_9497 == 0 )
        wait 0.1;

    scripts\mp\utility\perk::removeperk( "specialty_spygame" );
    self._id_7DDE = undefined;
}

_id_A1A5( var_0 )
{
    level endon( "game_ended" );

    for (;;)
    {
        var_0._id_487D = 0;

        foreach ( var_2 in level.players )
        {
            if ( var_2 _meth_81EF( self ) )
            {
                if ( var_2 getstance() == "stand" && _func_0131( var_2 getvelocity() ) > 40 )
                {
                    var_0._id_487D = 1;
                    var_0._id_3CE2 = 4;
                }

                if ( var_0._id_9497 )
                    var_2._id_82B2 = 1;
            }
        }

        wait 0.05;
    }
}

_id_A1A3( var_0 )
{
    level endon( "game_ended" );
    self endon( "lights_off" );
    self endon( "masterSwitch_on" );

    if ( isdefined( self._id_CE0B ) && self._id_CE0B == "motion" )
    {
        while ( var_0._id_3CE2 > 0 )
        {
            wait 0.1;
            var_0._id_3CE2 = var_0._id_3CE2 - 0.1;
        }
    }

    var_0._id_EC33 = "off";
}

_id_CA3F( var_0, var_1 )
{
    level endon( "game_ended" );
    var_2 = _id_3FE8( var_0, var_1 );

    if ( isdefined( var_2 ) )
        var_2 thread _id_10BA3( var_1 );
}

_id_3FE8( var_0, var_1 )
{
    var_2 = spawn( "script_model", self.origin, 40, 0, 60 );
    var_2 setmodel( "uk_electrical_box_medium_02_animated" );
    var_2.angles = self.angles;

    if ( self._id_CE0B == "motion" )
        return;

    var_3 = scripts\engine\utility::_id_678A();

    foreach ( var_5 in var_3 )
    {
        if ( var_5._id_00E1 == "script_origin" )
        {
            if ( isdefined( var_5._id_0375 ) && var_5._id_0375 == "sceneNode" )
                var_2._id_CBC3 = var_5;
            else
            {
                var_2._id_7973 = spawn( "script_model", var_5.origin );
                var_2._id_7973.angles = var_5.angles;
                var_2._id_7973 setmodel( var_5._id_0375 );
                var_2._id_7973._id_02AF = var_5._id_0375;
            }

            continue;
        }

        if ( var_5._id_00E1 == "light" )
        {
            var_2._id_7971 = var_5;
            continue;
        }
    }

    var_2 setuserange( 80 );
    var_2 _meth_84D3( 200 );
    var_2 setusefov( 120 );
    var_2 sethintdisplayfov( 120 );
    var_2 setcursorhint( "HINT_BUTTON" );

    if ( !scripts\cp_mp\utility\game_utility::_id_89D2() )
    {
        var_2 sethintstring( &"MP/LIGHT_SWITCH" );
        var_2 _meth_84D9( "icon_electrical_box" );
    }

    if ( scripts\cp_mp\utility\game_utility::isnightmap() )
    {
        var_2 _meth_83A0( 0 );
        var_2 makeuseable();
    }

    if ( isdefined( var_0._id_CE0B ) && var_0._id_CE0B == "motion" )
        var_1._id_EC33 = "motion";
    else
        var_1._id_EC33 = "off";

    foreach ( var_8 in level.players )
        var_2 _meth_80E0( var_8 );

    if ( isdefined( var_2._id_7973 ) && isdefined( var_2._id_7971 ) )
    {
        var_2._id_7972 = var_2._id_7971 _meth_8146();
        var_2 thread _id_9A1B( var_1 );
    }

    return var_2;
}

_id_10BA3( var_0 )
{
    level endon( "game_ended" );

    for (;;)
    {
        self waittill( "trigger", var_1 );

        if ( !isplayer( var_1 ) )
            continue;

        if ( isdefined( var_0._id_EC33 ) && var_0._id_EC33 == "on" )
            playsoundatpos( self.origin, "mp_fusebox_lever_off_npc" );
        else
            playsoundatpos( self.origin, "mp_fusebox_lever_on_npc" );

        thread _id_EC08( _func_0079( level._id_CC24["lightswitch"]["interact"] ) - 0.15, var_0 );
        var_2 = _id_94AB( var_1, var_0 );

        if ( !var_2 )
            self notify( "interactionCancelled" );
    }
}

_id_EC08( var_0, var_1 )
{
    self endon( "interactionCancelled" );
    wait( var_0 );

    if ( var_1._id_EC33 == "motion" || var_1._id_EC33 == "off" )
    {
        var_1._id_EC33 = "on";
        self notify( "masterSwitch_on" );
    }
    else
        var_1._id_EC33 = "off";
}

_id_9A1B( var_0 )
{
    level endon( "game_ended" );

    for (;;)
    {
        if ( var_0._id_EC33 == "on" )
        {
            self._id_7971 _meth_8337( 0 );
            self._id_7973 setmodel( self._id_7973._id_02AF );
        }
        else
        {
            self._id_7971 _meth_8337( self._id_7972 );
            self._id_7973 setmodel( self._id_7973._id_02AF + "_on" );
        }

        waitframe();
    }
}

_id_6AEC( var_0 )
{
    foreach ( var_2 in var_0 )
    {
        if ( isdefined( var_2._id_EC33 ) && var_2._id_EC33 == "on" )
            return "on";
    }

    return "motion";
}

_id_AB33( var_0, var_1 )
{
    foreach ( var_3 in var_0 )
    {
        if ( var_1 == "on" )
        {
            var_3 setmodel( var_3._id_02AF + "_on" );
            continue;
        }

        var_3 setmodel( var_3._id_02AF );

        if ( isdefined( var_3._id_5C32 ) )
            var_3._id_5C32 delete();
    }
}

_id_94AB( var_0, var_1 )
{
    var_2 = scripts\engine\utility::ter_op( var_1._id_EC33 == "on", "interact", "interact_on" );
    var_3 = scripts\engine\utility::ter_op( var_1._id_EC33 == "on", "lights_on", "lights_off" );
    level thread scripts\mp\battlechatter_mp::_id_F756( var_0, var_3 );
    self._id_1887 = "switch";
    self useanimtree( #animtree );
    self._id_CBC3 thread _id_069D::_id_181D( self, var_2 );
    var_4 = _func_0079( level._id_CC24["lightswitch"][var_2] );
    wait( var_4 );
    setdvar( "#x362c0bbc29a61b625", 0 );
    self notify( "interaction_complete" );
    return 1;
}

_id_10BD4( var_0 )
{
    self endon( "interaction_complete" );
    self._id_3136 = 0;

    for (;;)
    {
        if ( !isdefined( var_0 ) || !scripts\mp\utility\player::isreallyalive( var_0 ) )
        {
            self._id_3136 = 1;
            break;
        }

        waitframe();
    }
}

_id_3F3B( var_0, var_1, var_2 )
{
    if ( !isdefined( var_0 ) || isdefined( var_0._id_B591 ) )
        return;

    var_0._id_1887 = var_1;

    if ( !isdefined( var_2 ) )
        var_2 = "viewhands_base_iw8";

    var_0._id_B591 = spawn( "script_model", var_0.origin );
    var_0._id_B591 setmodel( var_2 );
    var_0._id_B591 hide();
    var_0._id_B591._id_1887 = var_1;
    var_0._id_B591 useanimtree( #animtree );
    var_0 playerlinktodelta( var_0._id_B591, "tag_player", 1, 0, 0, 0, 0, 0, 0 );
    var_0 _id_10A7C();
    _id_C428( var_0 );
}

_id_C428( var_0 )
{
    if ( !isdefined( var_0 ) || !isdefined( var_0._id_B591 ) )
        return;

    var_0 unlink();
    var_1 = var_0 _meth_812D( var_0.origin );

    if ( isdefined( var_1 ) )
        var_0 setorigin( var_1 );
    else
        var_0 setorigin( var_0.origin + ( 0, 0, 100 ) );

    var_0._id_B591 delete();
    var_0._id_B591 = undefined;
}

_id_10A7C( var_0 )
{
    scripts\engine\utility::waittill_any_2( "remove_rig", "death_or_disconnect" );
}
