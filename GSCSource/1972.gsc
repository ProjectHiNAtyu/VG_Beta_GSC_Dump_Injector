// S4 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

init()
{
    var_0 = _id_0A66::_id_6BDC( "scr_" + scripts\mp\utility\game::getgametype() + "_healthregentime", "scr_player_healthregentime" );
    _id_07FB::_id_D72D( "player", "healthregentime", var_0 );
    _id_07FB::_id_D72C( "player", "healthregentime", var_0 );
    level._id_7629 = _id_07FB::_id_6DF7( "player", "healthregentime" );
    level._id_762C = level._id_7629 <= 0;
    level._id_B6BF = level._id_7629;
    _id_0A7A::_id_C27F( ::_id_AB65 );
}

_id_AB65()
{
    thread _id_9A12();
    self visionsetthermalforplayer( game["thermal_vision"] );
}

_id_9A12()
{
    self endon( "death_or_disconnect" );
    self endon( "faux_spawn" );
    self._id_43E0 = 0;
    self._id_43E8 = 0;
    self._id_753A = 0;
    self _meth_83EE( "sys_deaths_door_exit" );
    self _meth_83EE( "sys_deaths_door_intro_impact" );
    self _meth_867E( "deaths_door_mp" );

    for (;;)
    {
        scripts\engine\utility::_id_108C3( "damage", "force_regeneration" );
        thread _id_7612();
    }
}

_id_AAB5()
{
    if ( istrue( self._id_43E0 ) )
        return;

    self._id_43E0 = 1;
    self._id_ADD2 = 0;

    if ( !istrue( self._id_43E8 ) )
    {
        self._id_43E8 = 1;
        self _meth_83EE( "sys_deaths_door_exit" );
        self playlocalsound( "sys_deaths_door_intro_impact" );
        self playlocalsound( "sys_deaths_door_lp_mp" );
        self _meth_867D( "deaths_door_mp", 0.2, 1 );
        _func_02DE( "deaths_door", "on", 0.05 );
        self _meth_8578( 0 );
        thread _id_B656();
    }

    if ( level._id_762C )
        self painvisionon();

    self notify( "deaths_door_enter" );
}

_id_AACC( var_0 )
{
    if ( istrue( var_0 ) )
    {
        self._id_ADD2 = 0;
        self._id_753A = 0;
    }

    if ( !istrue( self._id_43E0 ) )
        return;

    self._id_43E0 = 0;
    self._id_43E8 = 0;
    self _meth_83EE( "sys_deaths_door_intro_impact" );
    self playlocalsound( "sys_deaths_door_exit" );
    self _meth_83EE( "sys_deaths_door_lp_mp" );
    self _meth_83EE( "sys_deaths_door_breath_lp_mp" );
    self _meth_867E( "deaths_door_mp" );
    _func_02DE( "deaths_door", "", 0.05 );

    if ( level._id_762C )
        self _meth_8251();

    self notify( "deaths_door_exit" );
}

_id_AAE2()
{
    self notify( "healed" );
    level notify( "healed", self );
    thread _id_079A::_id_C4E7();
    self setclientomnvar( "ui_health_regen_hud", 0 );

    if ( level._id_609B )
        return;

    if ( scripts\mp\utility\player::_id_8AB5() )
        return;
}

_id_6A72( var_0 )
{
    if ( scripts\mp\utility\game::getgametype() == "br" )
    {
        if ( isdefined( var_0 ) )
        {
            if ( var_0 == "equip_bandages" )
                return self.maxhealth * _id_09DA::_id_68D7() / _id_09DA::_id_68D8();

            return self.maxhealth / _id_09DA::_id_6A1C();
        }
    }

    return 4;
}

_id_7612( var_0 )
{
    if ( !scripts\mp\utility\player::isreallyalive( self ) )
        return;

    self notify( "healhRegenThink" );
    self endon( "healhRegenThink" );
    self endon( "death_or_disconnect" );
    level endon( "game_ended" );
    var_1 = !istrue( self._id_118B ) && !istrue( self._id_2196 ) && !istrue( self._id_9059 );
    var_2 = self.health / self.maxhealth;

    if ( var_2 < 0.55 && !scripts\mp\utility\player::_id_8AB5() )
        _id_AAB5();

    if ( var_1 )
    {
        if ( level._id_762C )
            return;

        while ( istrue( self._id_762C ) || !scripts\mp\utility\player::_id_85D2() )
            waitframe();

        _id_10804();
    }

    if ( !var_1 || scripts\mp\utility\perk::_hasperk( "specialty_regenfaster" ) )
        self setclientomnvar( "ui_health_regen_hud", 1 );

    var_3 = self.maxhealth / 50.0;
    var_4 = 0.0;
    var_5 = self.health;
    var_6 = istrue( self._id_118B );

    for (;;)
    {
        if ( !scripts\mp\utility\player::_id_85D2() || istrue( self._id_762C ) && var_1 )
            return;

        wait 0.05;
        var_7 = var_3;

        if ( istrue( self._id_118B ) )
            var_7 = _id_09D3::_id_6A71();
        else if ( istrue( self._id_2196 ) )
        {
            var_7 = _id_6A72( var_0 );
            wait 1;
        }
        else if ( istrue( self._id_9059 ) )
            var_7 = _id_0A46::_id_9050();
        else if ( scripts\mp\utility\perk::_hasperk( "specialty_regenfaster" ) )
            var_7 = var_3 * level._id_C1B0;

        if ( self.health < self.maxhealth )
        {
            var_8 = self.health + var_7 + var_4;
            var_9 = int( min( self.maxhealth, var_8 ) );
            var_4 = var_8 - var_9;
            self.health = var_9;
            var_2 = self.health / self.maxhealth;

            if ( var_2 > 0.8 )
                _id_AACC( 1 );
        }

        if ( self.health >= self.maxhealth )
        {
            self.health = self.maxhealth;
            break;
        }
    }

    if ( var_6 )
    {
        var_10 = self.health - var_5;
        _id_079A::_id_3A9F( "equip_adrenaline", var_10 );
        _id_0A7B::_id_7D93( "stimDamageHealed", var_10 );
        _id_0793::_id_AB9B( var_10 );
        _id_0780::_id_9764( self, var_10, self );
    }

    if ( var_1 )
        level thread scripts\mp\battlechatter_mp::_id_F756( self, "player_recover" );

    _id_AAE2();
}

_id_10804()
{
    self endon( "force_regeneration" );
    self endon( "begin_regeneration" );
    self._id_DD01 = 0.0;

    if ( isdefined( self._id_902D ) )
    {
        var_0 = gettime();
        var_1 = var_0 - self._id_902D;
        var_1 = var_1 * 0.001;

        if ( scripts\mp\utility\perk::_hasperk( "specialty_shrapnel_resist" ) )
        {
            var_2 = 1;
            self._id_DD01 = max( var_2 - var_1, 0 );
        }
        else
            self._id_DD01 = max( 3 - var_1, 0 );
    }

    if ( !isdefined( self._id_C1AB ) )
        self._id_C1AB = 1;

    var_3 = self._id_DD01 > 0.0;

    if ( var_3 )
        thread _id_19BF();

    if ( !isdefined( self._id_C1AA ) || gettime() - self._id_C1AA > 150 )
        self._id_C1A9 = 0;

    var_4 = level._id_B6BF + self._id_DD01;
    self._id_41C5 = var_4;
    var_0 = gettime() * 0.001;

    while ( self._id_41C5 - self._id_C1A9 > 0 )
    {
        self._id_41C5 = self._id_41C5 - ( gettime() * 0.001 - var_0 ) * self._id_C1AB;
        var_0 = gettime() * 0.001;

        if ( var_3 && self._id_41C5 - self._id_C1A9 <= level._id_B6BF )
        {
            var_3 = 0;

            if ( self._id_C1A9 > 0 )
                self notify( "shrapnel_ended" );
            else
                self notify( "shrapnel_ended_early" );
        }

        wait 0.05;
    }

    if ( var_3 )
        self notify( "shrapnel_ended_early" );

    self._id_C1A9 = 0;
    self._id_C1AA = 0;
}

_id_C16E( var_0 )
{
    if ( !isdefined( self._id_C1A9 ) )
    {
        self._id_C1A9 = 0;
        self._id_C1AA = 0;
    }

    self._id_C1A9 = self._id_C1A9 + var_0;
    self._id_C1AA = gettime();
}

_id_B656( var_0 )
{
    self endon( "death_or_disconnect" );
    self endon( "deaths_door_exit" );
    self endon( "healed" );
    self endon( "last_stand_revived" );
    level endon( "game_ended" );
    wait 0.5;

    for (;;)
    {
        if ( scripts\mp\utility\player::_id_8AB5() )
        {
            waitframe();
            continue;
        }

        if ( level._id_762C )
        {
            self._id_ADD2++;

            if ( self._id_ADD2 > scripts\engine\utility::ter_op( istrue( self._id_753A ), 1, 4 ) )
            {
                wait 1.0;
                self._id_753A = 1;
                _id_AACC( 0 );
                break;
            }
        }

        wait 1.7;
    }
}

_id_19BF()
{
    self endon( "disconnect" );
    self notify( "applyShrapnelFX" );
    self endon( "applyShrapnelFX" );
    self setclientomnvar( "ui_shrapnel_overlay", 1 );
    var_0 = _id_19C0();

    if ( istrue( var_0 ) )
        self setclientomnvar( "ui_shrapnel_overlay", 2 );
    else
        self setclientomnvar( "ui_shrapnel_overlay", 3 );
}

_id_19C0()
{
    self endon( "death" );
    self endon( "joined_team" );
    self endon( "joined_spectators" );
    level endon( "game_ended" );
    var_0 = scripts\engine\utility::_id_10896( "shrapnel_ended_early", "shrapnel_ended", "force_regeneration" );
    return var_0 == "shrapnel_ended";
}
